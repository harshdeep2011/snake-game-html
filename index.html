<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Snake 3.0 - Harshdeep</title>

<style>
:root{
  --bg:#0b1220;
  --panel:#111a2e;
  --accent:#28c76f;
  --danger:#ff4d4d;
}
body{
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:linear-gradient(#071024,#0b1220);
  font-family:Arial;
  color:white;
}
.container{
  position:relative;
  width:600px;
  text-align:center;
}
canvas{
  background:var(--panel);
  border-radius:10px;
  box-shadow:0 0 25px rgba(40,199,111,0.4);
}
.overlay{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,0.85);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  gap:15px;
  border-radius:10px;
}
button,select{
  padding:10px 18px;
  font-size:16px;
  border:none;
  border-radius:6px;
}
button{
  background:var(--accent);
  font-weight:bold;
  cursor:pointer;
}
button:hover{opacity:0.85}
#leaderboard{
  margin-top:10px;
  font-size:14px;
  color:#aaa;
}
</style>
</head>

<body>

<div class="container">

<div id="menu" class="overlay">
  <h2>Snake 3.0</h2>
  <select id="difficulty">
    <option value="6">Easy</option>
    <option value="10" selected>Medium</option>
    <option value="16">Hard</option>
  </select>
  <button onclick="startGame()">Start Game</button>
</div>

<canvas id="game" width="600" height="600"></canvas>

<div>
Score: <span id="score">0</span> |
High: <span id="high">0</span>
</div>

<div id="leaderboard"></div>

</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
const grid=20;
const tile=canvas.width/grid;

let snake,dir,nextDir,food,powerUp;
let score=0,high=0;
let speed=10;
let state="menu";
let lastTime=0;
let accumulator=0;

const scoreEl=document.getElementById("score");
const highEl=document.getElementById("high");
const leaderboard=document.getElementById("leaderboard");
const menu=document.getElementById("menu");
const difficulty=document.getElementById("difficulty");

high=parseInt(localStorage.getItem("snakeHigh")||0);
highEl.textContent=high;
updateLeaderboard();

function startGame(){
  speed=parseInt(difficulty.value);
  reset();
  state="playing";
  menu.style.display="none";
}

function reset(){
  snake=[{x:10,y:10},{x:9,y:10},{x:8,y:10}];
  dir={x:1,y:0};
  nextDir={x:1,y:0};
  score=0;
  scoreEl.textContent=0;
  placeFood();
}

function placeFood(){
  food={
    x:Math.floor(Math.random()*grid),
    y:Math.floor(Math.random()*grid)
  };
  powerUp=Math.random()<0.2 ? {
    x:Math.floor(Math.random()*grid),
    y:Math.floor(Math.random()*grid)
  }:null;
}

function update(delta){
  accumulator+=delta;
  const interval=1000/speed;
  if(accumulator<interval)return;
  accumulator=0;

  dir=nextDir;
  const head={x:snake[0].x+dir.x,y:snake[0].y+dir.y};

  if(head.x<0||head.y<0||head.x>=grid||head.y>=grid||
     snake.some(s=>s.x===head.x&&s.y===head.y)){
    gameOver();
    return;
  }

  snake.unshift(head);

  if(head.x===food.x&&head.y===food.y){
    score++;
    playSound(600);
    scoreEl.textContent=score;
    if(score>high){
      high=score;
      localStorage.setItem("snakeHigh",high);
      highEl.textContent=high;
    }
    if(score%5===0) speed+=1;
    placeFood();
  }else if(powerUp && head.x===powerUp.x && head.y===powerUp.y){
    activatePower();
    powerUp=null;
  }else{
    snake.pop();
  }
}

function activatePower(){
  playSound(900);
  speed=Math.max(5,speed-3);
  setTimeout(()=>speed+=3,4000);
}

function gameOver(){
  playSound(200);
  saveScore(score);
  updateLeaderboard();
  state="gameover";
  menu.style.display="flex";
  menu.innerHTML=`
    <h2>Game Over</h2>
    <p>Score: ${score}</p>
    <button onclick="location.reload()">Restart</button>
  `;
}

function draw(){
  ctx.fillStyle="#071229";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  snake.forEach((s,i)=>{
    ctx.fillStyle=i===0?"#00ff88":"#28c76f";
    ctx.shadowColor="#28c76f";
    ctx.shadowBlur=10;
    ctx.fillRect(s.x*tile,s.y*tile,tile-2,tile-2);
  });
  ctx.shadowBlur=0;

  const pulse=Math.abs(Math.sin(Date.now()/200))*4;
  ctx.fillStyle="red";
  ctx.beginPath();
  ctx.arc(food.x*tile+tile/2,food.y*tile+tile/2,
          tile/2-2+pulse,0,Math.PI*2);
  ctx.fill();

  if(powerUp){
    ctx.fillStyle="gold";
    ctx.beginPath();
    ctx.arc(powerUp.x*tile+tile/2,powerUp.y*tile+tile/2,
            tile/2-4,0,Math.PI*2);
    ctx.fill();
  }
}

function gameLoop(timestamp){
  const delta=timestamp-lastTime;
  lastTime=timestamp;
  if(state==="playing"){
    update(delta);
    draw();
  }
  requestAnimationFrame(gameLoop);
}
requestAnimationFrame(gameLoop);

window.addEventListener("keydown",e=>{
  if(e.key==="ArrowUp"&&dir.y!==1)nextDir={x:0,y:-1};
  if(e.key==="ArrowDown"&&dir.y!==-1)nextDir={x:0,y:1};
  if(e.key==="ArrowLeft"&&dir.x!==1)nextDir={x:-1,y:0};
  if(e.key==="ArrowRight"&&dir.x!==-1)nextDir={x:1,y:0};
  if(e.key===" "&&state==="playing") state="paused";
  else if(e.key===" "&&state==="paused") state="playing";
});

function playSound(freq){
  const audio=new (window.AudioContext||window.webkitAudioContext)();
  const osc=audio.createOscillator();
  osc.type="square";
  osc.frequency.value=freq;
  osc.connect(audio.destination);
  osc.start();
  osc.stop(audio.currentTime+0.1);
}

function saveScore(s){
  let scores=JSON.parse(localStorage.getItem("snakeScores"))||[];
  scores.push(s);
  scores.sort((a,b)=>b-a);
  scores=scores.slice(0,5);
  localStorage.setItem("snakeScores",JSON.stringify(scores));
}

function updateLeaderboard(){
  let scores=JSON.parse(localStorage.getItem("snakeScores"))||[];
  leaderboard.innerHTML="<b>Top 5 Scores</b><br>"+scores.join("<br>");
}
</script>

</body>
</html>
